@page "/"
@using System.Globalization;
@using Microsoft.AspNetCore.Components
@using MudBlazor
@using RcTireManager.Components.Pages
@using RcTireManager.Data.DTO
@using RcTireManager.Interfaces.Viewmodels
@using RcTireManager.Viewmodels
@inherits LayoutComponentBase
@inject IViewModelHome _viewModelHome

<MudLayout>
    <MudMainContent>
        @Body
    </MudMainContent>
</MudLayout>

<div style="display: grid; grid-template-columns: 1vh 98vh 1vh;">
    <MudPaper Class="pa-16 ma-2" Elevation="0" Style="grid-column: 2">
        <div style="display: grid; grid-template-rows: 8vh 8vh 8vh 8vh 8vh 8vh; gap: 2vh">
            <div style="grid-row: 1">
                <MudSelect T="CarDTO" @bind-value="_viewModelHome.SelectedCar"
                           Label="Select Car">
                    @foreach (CarDTO car in _viewModelHome.Cars)
                    {
                        <MudSelectItem Value="car">@car.Name</MudSelectItem>
                    }
                </MudSelect>
            </div>
            <div style="grid-row: 2">
                <MudSelect T="TireSetDTO" @bind-value="_viewModelHome.SelectedTireSet"
                           Label="Select Tire">
                    @foreach (TireSetDTO set in _viewModelHome.TireSets)
                    {
                        <MudSelectItem Value="set">@set.Name</MudSelectItem>
                    }
                </MudSelect>
            </div>
            <div style="grid-row: 3">
                <MudText><b>Previous runtime:</b> @_viewModelHome.SelectedTireSet?.RunTime</MudText>
            </div>
            <div style="grid-row: 4">
                <MudBlazor.MudTimePicker Label="Choose run time" TimeEditMode="TimeEditMode.OnlyMinutes" PickerVariant="PickerVariant.Dialog" @bind-Time="_viewModelHome.RunTime" />
            </div>
            <div style="grid-row: 5">
                <MudBlazor.MudButton FullWidth="true" Variant="Variant.Filled" Color="Color.Info" StartIcon="@Icons.Material.Filled.Save" onclick="SaveRun">Save Run</MudBlazor.MudButton>
            </div>
        </div>
    </MudPaper>
</div>